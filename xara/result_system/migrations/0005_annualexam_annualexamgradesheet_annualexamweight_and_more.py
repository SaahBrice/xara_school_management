# Generated by Django 5.1 on 2024-09-16 20:57

import django.core.validators
import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('result_system', '0004_alter_generalexamclassstatistics_avg_score_and_more'),
    ]

    operations = [
        migrations.CreateModel(
            name='AnnualExam',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(default='Annual Results', max_length=100)),
                ('start_date', models.DateTimeField()),
                ('end_date', models.DateTimeField()),
                ('total_coefficient', models.DecimalField(decimal_places=2, default=1.0, max_digits=5)),
                ('academic_year', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_exams', to='result_system.academicyear')),
                ('school', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_exams', to='result_system.school')),
            ],
        ),
        migrations.CreateModel(
            name='AnnualExamGradeSheet',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('credits_attempted', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('credits_obtained', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('total_score', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('average', models.DecimalField(blank=True, decimal_places=2, max_digits=4, null=True)),
                ('rank', models.PositiveIntegerField(blank=True, null=True)),
                ('remark', models.CharField(blank=True, max_length=20)),
                ('academic_year', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_exam_grade_sheets', to='result_system.academicyear')),
                ('annual_exam', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='grade_sheets', to='result_system.annualexam')),
                ('class_obj', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_exam_grade_sheets', to='result_system.class')),
                ('student', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_exam_grade_sheets', to='result_system.student')),
            ],
            options={
                'unique_together': {('student', 'annual_exam', 'class_obj', 'academic_year')},
            },
        ),
        migrations.CreateModel(
            name='AnnualExamWeight',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('weight', models.DecimalField(decimal_places=2, default=1.0, max_digits=3, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(1)])),
                ('annual_exam', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='result_system.annualexam')),
                ('general_exam', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='result_system.generalexam')),
            ],
            options={
                'unique_together': {('annual_exam', 'general_exam')},
            },
        ),
        migrations.AddField(
            model_name='annualexam',
            name='general_exams',
            field=models.ManyToManyField(related_name='annual_exams', through='result_system.AnnualExamWeight', to='result_system.generalexam'),
        ),
        migrations.CreateModel(
            name='AnnualExamClassStatistics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('max_score', models.DecimalField(decimal_places=2, max_digits=4, null=True)),
                ('min_score', models.DecimalField(decimal_places=2, max_digits=4, null=True)),
                ('avg_score', models.DecimalField(decimal_places=2, max_digits=4, null=True)),
                ('num_students', models.PositiveIntegerField(null=True)),
                ('num_passed', models.PositiveIntegerField(null=True)),
                ('percentage_passed', models.DecimalField(decimal_places=2, max_digits=5, null=True)),
                ('academic_year', models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, related_name='annual_exam_class_statistics_year', to='result_system.academicyear')),
                ('annual_exam', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='class_statistics', to='result_system.annualexam')),
                ('class_obj', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_exam_class_statistics', to='result_system.class')),
                ('class_subject', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_exam_statistics', to='result_system.classsubject')),
            ],
            options={
                'unique_together': {('annual_exam', 'class_obj', 'class_subject')},
            },
        ),
        migrations.CreateModel(
            name='AnnualExamOverallStatistics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('num_students', models.PositiveIntegerField()),
                ('num_passes', models.PositiveIntegerField()),
                ('class_average', models.DecimalField(decimal_places=2, max_digits=4)),
                ('overall_percentage_pass', models.DecimalField(decimal_places=2, max_digits=5)),
                ('academic_year', models.ForeignKey(null=True, on_delete=django.db.models.deletion.CASCADE, related_name='annual_exam_overall_statistics_year', to='result_system.academicyear')),
                ('annual_exam', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='overall_statistics', to='result_system.annualexam')),
                ('class_obj', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_exam_overall_statistics', to='result_system.class')),
            ],
            options={
                'unique_together': {('annual_exam', 'class_obj')},
            },
        ),
        migrations.CreateModel(
            name='AnnualExamSubjectGrade',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('calculated_score', models.DecimalField(blank=True, decimal_places=2, max_digits=4, null=True)),
                ('rank', models.PositiveIntegerField(blank=True, null=True)),
                ('observation', models.CharField(blank=True, max_length=50)),
                ('class_subject', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='annual_exam_grades', to='result_system.classsubject')),
                ('grade_sheet', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='subject_grades', to='result_system.annualexamgradesheet')),
            ],
            options={
                'unique_together': {('grade_sheet', 'class_subject')},
            },
        ),
        migrations.AlterUniqueTogether(
            name='annualexam',
            unique_together={('school', 'name', 'academic_year')},
        ),
    ]
